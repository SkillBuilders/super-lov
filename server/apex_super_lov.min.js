(function(a){a.widget("ui.apex_super_lov",{options:{enterable:null,returnColNum:null,displayColNum:null,hiddenCols:null,searchableCols:null,mapFromCols:null,mapToItems:null,maxRowsPerPage:null,dialogTitle:null,useClearProtection:null,noDataFoundMsg:null,loadingImageSrc:null,ajaxIdentifier:null,reportHeaders:null,effectsSpeed:null,dependingOnSelector:null,pageItemsToSubmit:null,debug:a("#pdebug").length!==0},_createPrivateStorage:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Create Private Storage ("+a(b.element).attr("id")+")")}b._values={apexItemId:"",controlsId:"",deleteIconTimeout:"",searchString:"",pagination:"",fetchLovInProcess:false,fetchLovMode:"",ajaxReturn:"",curPage:"",moreRows:false,wrapperHeight:0,dialogHeight:0,dialogWidth:0,dialogTop:0,dialogLeft:0,percentRegExp:/^-?[0-9]+\.?[0-9]*%$/,pixelRegExp:/^-?[0-9]+\.?[0-9]*px$/i,hiddenCols:(b.options.hiddenCols)?b.options.hiddenCols.split(","):[],searchableCols:(b.options.searchableCols)?b.options.searchableCols.split(","):[],mapFromCols:(b.options.mapFromCols)?b.options.mapFromCols.split(","):[],mapToItems:(b.options.mapToItems)?b.options.mapToItems.split(","):[],bodyKeyMode:"SEARCH",disabled:false,focusOnClose:"BUTTON",ENTERABLE_RESTRICTED:"ENTERABLE_RESTRICTED",ENTERABLE_UNRESTRICTED:"ENTERABLE_UNRESTRICTED",lastDisplayValue:"",changePropagationAllowed:false};if(b.options.debug){apex.debug("...Private Values");for(name in b._values){apex.debug("......"+name+': "'+b._values[name]+'"')}}b._elements={$itemHolder:{},$window:{},$hiddenInput:{},$displayInput:{},$label:{},$fieldset:{},$clearButton:{},$openButton:{},$outerDialog:{},$dialog:{},$buttonContainer:{},$searchContainer:{},$paginationContainer:{},$columnSelect:{},$filter:{},$goButton:{},$prevButton:{},$paginationDisplay:{},$nextButton:{},$wrapper:{},$table:{},$nodata:{},$moreRows:{},$selectedRow:{},$actionlessFocus:{}};if(b.options.debug){apex.debug("...Cashed Elements");for(name in b._elements){apex.debug("......"+name+': "'+b._elements[name]+'"')}}},_create:function(){var d=this;var g;var c;var f;var h;var b;var e;if(d.options.debug){apex.debug("Super LOV - Initialize ("+a(d.element).attr("id")+")");apex.debug("...Options");for(name in d.options){apex.debug("......"+name+': "'+d.options[name]+'"')}}d._createPrivateStorage();d._values.apexItemId=a(d.element).attr("id");d._values.controlsId=d._values.apexItemId+"_fieldset";d._initBaseElements();d._values.lastDisplayValue=d._elements.$displayInput.val();c=d._elements.$displayInput.css("background-color");f=d._elements.$displayInput.css("background-image");h=d._elements.$displayInput.css("background-repeat");b=d._elements.$displayInput.css("background-attachment");e=d._elements.$displayInput.css("background-position");d._elements.$fieldset.css({"background-color":c,"background-image":f,"background-repeat":h,"background-attachment":b,"background-position":e});d._elements.$openButton.button({text:false,label:"Open Dialog",icons:{primary:"ui-icon-circle-triangle-n"}}).css("height",d._elements.$displayInput.outerHeight(true)).bind("click",{uiw:d},d._handleOpenClick);d._elements.$clearButton.button({text:false,label:"Clear Contents",icons:{primary:"ui-icon-circle-close"}}).css("height",d._elements.$displayInput.outerHeight(true)).bind("click",{uiw:d},d._handleClearClick).parent().buttonset();d._elements.$clearButton.removeClass("ui-corner-left");d._elements.$displayInput.bind("apexrefresh",function(){d._refresh()});if(d.options.enterable===d._values.ENTERABLE_RESTRICTED||d.options.enterable===d._values.ENTERABLE_UNRESTRICTED){d._elements.$displayInput.bind("keypress",{uiw:d},d._handleEnterableKeypress).bind("blur",{uiw:d},d._handleEnterableBlur)}if(d.options.dependingOnSelector){a(d.options.dependingOnSelector).bind("change",function(){d._elements.$displayInput.trigger("apexrefresh")})}apex.widget.initPageItem(d._elements.$displayInput.attr("id"),{setValue:function(k,j){d._elements.$hiddenInput.val(k);d._elements.$displayInput.val(j);d._values.lastDisplayValue=j},getValue:function(){return d._elements.$hiddenInput.val()},show:function(){d.show()},hide:function(){d.hide()},enable:function(){d.enable()},disable:function(){d.disable()}})},_initBaseElements:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Initialize Base Elements ("+b._values.apexItemId+")")}b._elements.$itemHolder=a("table#"+b._values.apexItemId+"_holder");b._elements.$hiddenInput=a("#"+b._values.apexItemId+"_HIDDENVALUE");b._elements.$displayInput=b.element;b._elements.$label=a('label[for="'+b._values.apexItemId+'"]');b._elements.$fieldset=a("#"+b._values.controlsId);b._elements.$clearButton=a("#"+b._values.controlsId+" button.superlov-modal-delete");b._elements.$openButton=a("#"+b._values.controlsId+" button.superlov-modal-open")},_initElements:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Initialize Elements ("+b._values.apexItemId+")")}b._elements.$window=a(window);b._elements.$outerDialog=a("div.superlov-dialog");b._elements.$dialog=a("div.superlov-container");b._elements.$buttonContainer=a("div.superlov-button-container");b._elements.$searchContainer=a("div.superlov-search-container");b._elements.$paginationContainer=a("div.superlov-pagination-container");b._elements.$columnSelect=a("select#superlov-column-select");b._elements.$filter=a("input#superlov-filter");b._elements.$searchButton=a("div.superlov-search-icon");b._elements.$prevButton=a("button#superlov-prev-page");b._elements.$paginationDisplay=a("span#superlov-pagination-display");b._elements.$nextButton=a("button#superlov-next-page");b._elements.$wrapper=a("div.superlov-table-wrapper");b._elements.$actionlessFocus=a("#superlov-focusable")},_initTransientElements:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Initialize Transient Elements ("+b._values.apexItemId+")")}b._elements.$table=a("table.superlov-table");b._elements.$nodata=a("div.superlov-nodata");b._elements.$moreRows=a("input#asl-super-lov-more-rows")},_initButtons:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Initialize Buttons ("+b._values.apexItemId+")")}b._elements.$searchButton.bind("click",{uiw:b},b._handleSearchButtonClick);b._elements.$prevButton.button({text:false,icons:{primary:"ui-icon-arrowthick-1-w"}}).bind("click",{uiw:b},b._handlePrevButtonClick);b._elements.$nextButton.button({text:false,icons:{primary:"ui-icon-arrowthick-1-e"}}).bind("click",{uiw:b},b._handleNextButtonClick)},_initColumnSelect:function(){var c=this;var d=c._elements.$columnSelect.get(0);var b=1;if(c.options.debug){apex.debug("Super LOV - Initialize Column Select ("+c._values.apexItemId+")")}for(x=0;x<c.options.reportHeaders.length;x++){if(!c._isHiddenCol(x+1)&&c._isSearchableCol(x+1)){d.options[b]=new Option(c.options.reportHeaders[x],x+1);b+=1}}a('select#superlov-column-select option[value="'+c.options.displayColNum+'"]').attr("selected","selected")},_handleColumnChange:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Handle Column Change ("+b._values.apexItemId+")")}if(b._elements.$columnSelect.val()){b._elements.$filter.removeAttr("disabled")}else{b._elements.$filter.val("").attr("disabled","disabled")}b._updateStyledFilter()},_ieNoSelectText:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - IE No Select Text ("+b._values.apexItemId+")")}if(document.attachEvent){a("div.superlov-table-wrapper *").each(function(){a(this)[0].attachEvent("onselectstart",function(){return false})})}},_isHiddenCol:function(c){var d=this;var b=false;if(d.options.debug){apex.debug("Super LOV - Is Hidden Column ("+d._values.apexItemId+")")}for(i=0;i<d._values.hiddenCols.length;i++){if(parseInt(c,10)===parseInt(d._values.hiddenCols[i],10)){b=true;break}}return b},_isSearchableCol:function(c){var d=this;var b=false;if(d.options.debug){apex.debug("Super LOV - Is Searchable Column ("+d._values.apexItemId+")")}if(d._values.searchableCols.length){for(i=0;i<d._values.searchableCols.length;i++){if(parseInt(c,10)===parseInt(d._values.searchableCols[i],10)){b=true;break}}}else{b=true}return b},_showDialog:function(){var j=this;var m;var b;var h;if(j.options.debug){apex.debug("Super LOV - Show Dialog ("+j._values.apexItemId+")")}h='<div class="superlov-container ui-widget">\n   <div class="superlov-button-container ui-widget-header ui-corner-all ui-helper-clearfix">\n      <div class="superlov-search-container">\n         <table>\n            <tr>\n               <td valign="middle">\n                  Search<a id="superlov-focusable" href="#" style="text-decoration: none;">&nbsp;</a>\n               </td>\n               <td valign="middle">\n                  <select id="superlov-column-select" size="1">\n                     <option value="">- Select Column -</option>\n                  </select>\n               </td>\n               <td>\n                  <div id="superlov_styled_filter" class="ui-corner-all">\n                     <table>\n                        <tbody>\n                           <tr>\n                              <td>\n                                 <input type="text" id="superlov-filter" class="ui-corner-all"/>\n                              </td>\n                              <td>\n                                 <div class="ui-state-highlight superlov-search-icon"><span class="ui-icon ui-icon-circle-zoomin"></span></div>\n                              </td>\n                           </tr>\n                        </tbody>\n                     </table>\n                  </div>\n               </td>\n            </tr>\n         </table>\n      </div>\n      <div class="superlov-pagination-container">\n         <table>\n            <tr>\n               <td valign="middle">\n                  <button id="superlov-prev-page">Previous Page</button>\n               </td>\n               <td valign="middle">\n                  <span id="superlov-pagination-display">Page 1</span>\n               </td>\n               <td valign="middle">\n                  <button id="superlov-next-page">Next Page</button>\n               </td>\n            </tr>\n         </table>\n      </div>\n   </div>\n      <div class="superlov-table-wrapper">\n         <img id="superlov-loading-image" src="'+j.options.loadingImageSrc+'">\n   </div>\n</div>\n';a("body").append(h);j._initElements();j._values.pagination="1:"+j.options.maxRowsPerPage;j._values.curPage=1;j._initButtons();j._initColumnSelect();j._elements.$columnSelect.bind("change",function(){j._handleColumnChange()});j._elements.$filter.bind("focus",{uiw:j},j._handleFilterFocus);var c=j._elements.$filter.css("border-top-color");var n=j._elements.$filter.css("border-top-width");var l=j._elements.$filter.css("border-top-style");var g=j._elements.$filter.css("background-color");var f=j._elements.$filter.css("background-image");var k=j._elements.$filter.css("background-repeat");var e=j._elements.$filter.css("background-attachment");var d=j._elements.$filter.css("background-position");if((a.browser.msie||a.browser.webkit)&&c!=="none"){c="#aaaaaa";if(a.browser.msie&&l==="none"){l="inset"}}j._elements.$filter.css("border","none");a("#superlov_styled_filter").css({"border-color":c,"border-width":n,"border-style":l,"background-color":g,"background-image":f,"background-repeat":k,"background-attachment":e,"background-position":d});j._disableSearchButton();j._disablePrevButton();j._disableNextButton();m=j._elements.$searchContainer.width()+j._elements.$paginationContainer.width();j._elements.$buttonContainer.css("width",m+10+"px");b=j._elements.$buttonContainer.height();j._elements.$paginationContainer.css("height",b+"px");j._elements.$searchContainer.css("height",b+"px");j._elements.$dialog.dialog({disabled:false,autoOpen:false,closeOnEscape:true,closeText:"Close",dialogClass:"superlov-dialog",draggable:true,height:"auto",hide:null,maxHeight:false,maxWidth:false,minHeight:150,minWidth:false,modal:true,resizable:false,show:null,stack:true,title:j.options.dialogTitle,open:function(){j._elements.$filter.trigger("focus");if(j._values.fetchLovMode==="DIALOG"){j._fetchLov()}else{if(j._values.fetchLovMode==="ENTERABLE"){j._elements.$filter.val(j._values.searchString)}}j._values.fetchLovMode="DIALOG";if(a.browser.msie){j._elements.$dialog.css("height","auto")}},close:function(){a("body").unbind("keydown",j._handleBodyKeydown);a(document).unbind("keydown",j._disableArrowKeyScrolling);a("table.superlov-table tbody tr").die();j._values.fetchLovInProcess=false;a(this).dialog("destroy");j._elements.$dialog.remove();if(j._values.focusOnClose==="BUTTON"){j._elements.$openButton.focus()}else{if(j._values.focusOnClose==="INPUT"){j._elements.$displayInput.focus()}}if(j._elements.$displayInput.val()===""){j.allowChangePropagation();j._elements.$hiddenInput.trigger("change");j._elements.$displayInput.trigger("change");j.preventChangePropagation()}j._values.focusOnClose="BUTTON"}});j._initElements();j._elements.$dialog.css("overflow","hidden");j._elements.$outerDialog.css("min-width",m+42+"px");j._values.dialogTop=j._elements.$window.height()*0.05;j._values.dialogLeft=(j._elements.$window.width()/2)-(j._elements.$outerDialog.outerWidth(true)/2);if(j._values.dialogLeft<0){j._values.dialogLeft=0}j._elements.$dialog.dialog("option","position",[j._values.dialogLeft,j._values.dialogTop]);j._ieNoSelectText();a("body").bind("keydown",{uiw:j},j._handleBodyKeydown);a(document).bind("keydown",{uiw:j},j._disableArrowKeyScrolling);a("table.superlov-table tbody tr").live("mouseenter",{uiw:j},j._handleMainTrMouseenter).live("mouseleave",{uiw:j},j._handleMainTrMouseleave).live("click",{uiw:j},j._handleMainTrClick);j._elements.$window.bind("resize",{uiw:j},j._handleWindowResize);j._elements.$dialog.dialog("open")},_handleWindowResize:function(d){var c=d.data.uiw;var b;if(c.options.debug){apex.debug("Super LOV - Handle Window Resize ("+c._values.apexItemId+")")}if(!c._elements.$table.length&&!c._elements.$nodata.length){c._initTransientElements()}c._updateLovMeasurements();c._elements.$outerDialog.css({height:c._values.dialogHeight,width:c._values.dialogWidth});c._elements.$wrapper.css({height:c._values.wrapperHeight,width:c._values.wrapperWidth,overflow:"hidden"});b=(c._elements.$window.width()/2)-(c._elements.$outerDialog.outerWidth(true)/2);if(b<0){b=0}c._elements.$outerDialog.css({top:c._values.dialogTop,left:b});c._elements.$wrapper.css("overflow","auto")},_handleBodyKeydown:function(g){var f=g.data.uiw;var e;var c;var d;var b;if(f.options.debug){apex.debug("Super LOV - Handle Body Keydown ("+f._values.apexItemId+")")}if(g.which===37&&!f._elements.$prevButton.attr("disabled")){if(f._values.bodyKeyMode==="ROWSELECT"){f._handlePrevButtonClick(g)}}else{if(g.which===39&&!f._elements.$nextButton.attr("disabled")){if(f._values.bodyKeyMode==="ROWSELECT"){f._handleNextButtonClick(g)}}else{if(g.which===38&&g.target!=f._elements.$columnSelect[0]){f._values.bodyKeyMode="ROWSELECT";f._elements.$actionlessFocus.trigger("focus");e=f._elements.$table.find("tbody>tr").has("td.ui-state-hover");if(e.length===0){c=f._elements.$table.find("tbody>tr:last")}else{if(e.get(0)===f._elements.$table.find("tbody>tr:first").get(0)){c=f._elements.$table.find("tbody>tr:last")}else{c=e.prev()}}e.trigger("mouseout");c.trigger("mouseover").focus();d=c.position().top-f._elements.$wrapper.position().top;b={top:0,bottom:f._elements.$wrapper.outerHeight(true)};if(c[0]===f._elements.$table.find("tbody>tr:first")[0]){f._elements.$wrapper.scrollTop(0)}else{if(d<b.top){f._elements.$wrapper.scrollTop(f._elements.$wrapper.scrollTop()+d-5)}else{if(d+c.height()>b.bottom){f._elements.$wrapper.scrollTop(f._elements.$wrapper.scrollTop()+d+c.height()-b.bottom+5)}}}}else{if(g.which===40&&g.target!=f._elements.$columnSelect[0]){f._values.bodyKeyMode="ROWSELECT";f._elements.$actionlessFocus.trigger("focus");e=f._elements.$table.find("tbody>tr").has("td.ui-state-hover");if(e.length===0){c=f._elements.$table.find("tbody>tr:first")}else{if(e.get(0)===f._elements.$table.find("tbody>tr:last").get(0)){c=f._elements.$table.find("tbody>tr:first")}else{c=e.next()}}e.trigger("mouseout");c.trigger("mouseover").focus();d=c.position().top-f._elements.$wrapper.position().top;b={top:0,bottom:f._elements.$wrapper.outerHeight(true)};if(c[0]===f._elements.$table.find("tbody>tr:first")[0]){f._elements.$wrapper.scrollTop(0)}else{if(d<b.top){f._elements.$wrapper.scrollTop(f._elements.$wrapper.scrollTop()+d-5)}else{if(d+c.height()>b.bottom){f._elements.$wrapper.scrollTop(f._elements.$wrapper.scrollTop()+d+c.height()-b.bottom+5)}}}}else{if(g.which===13){if(f._values.bodyKeyMode==="ROWSELECT"&&g.target!=f._elements.$columnSelect[0]&&g.target!=f._elements.$prevButton[0]&&g.target!=f._elements.$nextButton[0]&&g.target!=f._elements.$searchButton[0]){a("#superlov-fetch-results>tbody>tr").has("td.ui-state-hover").trigger("click");g.preventDefault();return false}else{if(f._values.bodyKeyMode==="SEARCH"&&g.target!=f._elements.$displayInput[0]&&g.target!=f._elements.$columnSelect[0]&&g.target!=f._elements.$prevButton[0]&&g.target!=f._elements.$nextButton[0]&&g.target!=f._elements.$searchButton[0]){f._search()}}}}}}}},_handleOpenClick:function(c){var b=c.data.uiw;if(b.options.debug){apex.debug("Super LOV - Handle Open Click")}b._values.fetchLovMode="DIALOG";b._values.searchString="";b._showDialog()},_handleEnterableKeypress:function(c){var b=c.data.uiw;if(c.which===13&&b._elements.$displayInput.val()!==b._values.lastDisplayValue){b._values.focusOnClose="INPUT";b._elements.$displayInput.trigger("blur")}},_handleEnterableBlur:function(c){var b=c.data.uiw;if(b._elements.$displayInput.val()!==b._values.lastDisplayValue){b._values.lastDisplayValue=b._elements.$displayInput.val();b._handleEnterableChange()}},_handleEnterableChange:function(){var b=this;for(x=0;x<b._values.mapToItems.length;x++){$s(b._values.mapToItems[x],"")}if(b.options.enterable===b._values.ENTERABLE_RESTRICTED){if(b._elements.$displayInput.val()){b._values.fetchLovMode="ENTERABLE";b._fetchLov()}else{b._elements.$hiddenInput.val("")}}else{if(b.options.enterable===b._values.ENTERABLE_UNRESTRICTED){b._elements.$hiddenInput.val(b._elements.$displayInput.val())}}},_fetchLov:function(){var c=this;var b;var f;var e=0;var d;if(c.options.debug){apex.debug("Super LOV - Fetch LOV ("+c._values.apexItemId+")")}if(c._values.fetchLovInProcess){return}else{c._values.fetchLovInProcess=true}if(c._values.fetchLovMode==="DIALOG"){d=true;e=Math.floor(Math.random()*10000000001);c._elements.$wrapper.data("fetchLovId",e);c._disableSearchButton();c._disablePrevButton();c._disableNextButton();c._elements.$window.unbind("resize",c._handleWindowResize);if(c._elements.$columnSelect.val()&&c._elements.$filter.val()){b=c._elements.$columnSelect.val();c._values.searchString=c._elements.$filter.val()}else{c._values.searchString=""}}else{if(c._values.fetchLovMode==="ENTERABLE"){d=false;c._elements.$fieldset.after('<span class="loading-indicator superlov-loading"></span>');c._values.pagination="1:"+c.options.maxRowsPerPage;b=c.options.displayColNum;c._values.searchString=c._elements.$displayInput.val()}}f={p_flow_id:a("#pFlowId").val(),p_flow_step_id:a("#pFlowStepId").val(),p_instance:a("#pInstance").val(),p_request:"PLUGIN="+c.options.ajaxIdentifier,x01:"FETCH_LOV",x02:c._values.pagination,x03:b,x04:c._values.searchString,x05:e,p_arg_names:[],p_arg_values:[]};a(c.options.dependingOnSelector).add(c.options.pageItemsToSubmit).each(function(g){f.p_arg_names[g]=this.id;f.p_arg_values[g]=$v(this)});a.ajax({type:"POST",url:"wwv_flow.show",data:f,dataType:"text",async:d,success:function(g){c._values.ajaxReturn=g;c._handleFetchLovReturn()}})},_handleFetchLovReturn:function(){var e=this;var d;var c;var b=a(e._values.ajaxReturn);if(e.options.debug){apex.debug("Super LOV - Handle Fetch LOV Return ("+e._values.apexItemId+")")}if(e._values.fetchLovMode==="DIALOG"&&Number(a(e._values.ajaxReturn).attr("data-fetch-lov-id"))!==e._elements.$wrapper.data("fetchLovId")){if(e.options.debug){apex.debug("...Ajax return mismatch - exiting early")}return}c=b.find("tr").length-1;if(e._values.fetchLovMode==="ENTERABLE"){e._elements.$fieldset.next("span.loading-indicator").remove();if(c===1){if(e.options.debug){apex.debug("...Found exact match, setting display and return inputs")}e._values.fetchLovInProcess=false;e._elements.$selectedRow=b.find("tr:eq(1)");e._setValuesFromRow();return}else{if(e.options.debug){apex.debug("...Exact match not found, opening dialog")}e._elements.$hiddenInput.val("");e._elements.$displayInput.val("");e._values.lastDisplayValue="";e._showDialog()}}e._elements.$wrapper.fadeTo(0,0).css({width:"100000px",height:"0px",overflow:"hidden"}).empty();if(c===0){d='<div class="ui-widget superlov-nodata">\n   <div class="ui-state-highlight ui-corner-all" style="padding: 0pt 0.7em;">\n      <p>\n      <span class="ui-icon ui-icon-alert" style="float: left; margin-right:0.3em;"></span>\n      '+e.options.noDataFoundMsg+"\n      </p>\n   </div>\n</div>\n";e._elements.$wrapper.html(d)}else{e._elements.$wrapper.html(e._values.ajaxReturn);a("table.superlov-table th:first").addClass("ui-corner-tl");a("table.superlov-table th:last").addClass("ui-corner-tr");a("table.superlov-table tr:last td:first").addClass("ui-corner-bl");a("table.superlov-table tr:last td:last").addClass("ui-corner-br")}e._ieNoSelectText();e._initTransientElements();e._values.moreRows=(e._elements.$moreRows.val()==="Y")?true:false;e._highlightSelectedRow();e._updatePaginationDisplay();e._enableSearchButton();if(e._values.moreRows){e._enableNextButton()}else{e._disableNextButton()}if(e._elements.$table.length){apex.debug("wrapper width: "+e._elements.$wrapper.width());apex.debug("table width: "+e._elements.$table.width());e._elements.$table.width(e._elements.$table.width())}else{if(e._elements.$nodata.length){e._elements.$nodata.width(e._elements.$nodata.width())}}e._resizeModal();e._values.fetchLovInProcess=false},_resizeModal:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Resize Modal ("+b._values.apexItemId+")")}b._updateLovMeasurements();if(b.options.effectsSpeed===0){b._elements.$outerDialog.css({height:b._values.dialogHeight,width:b._values.dialogWidth,left:b._values.dialogLeft});if(b._elements.$nodata.length){b._elements.$nodata.width(b._values.wrapperWidth)}b._elements.$wrapper.css({height:b._values.wrapperHeight,width:b._values.wrapperWidth,overflow:"auto"}).fadeTo(b.options.effectsSpeed,1);b._elements.$window.bind("resize",{uiw:b},b._handleWindowResize)}else{b._elements.$outerDialog.animate({height:b._values.dialogHeight},b.options.effectsSpeed,function(){b._elements.$outerDialog.animate({width:b._values.dialogWidth,left:b._values.dialogLeft},b.options.effectsSpeed,function(){if(b._elements.$nodata.length){b._elements.$nodata.width(b._values.wrapperWidth)}b._elements.$wrapper.css({height:b._values.wrapperHeight,width:b._values.wrapperWidth,overflow:"auto"}).fadeTo(b.options.effectsSpeed,1);b._elements.$window.bind("resize",{uiw:b},b._handleWindowResize)})})}},_search:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Search ("+b._values.apexItemId+")")}b._values.curPage=1;b._values.pagination="1:"+b.options.maxRowsPerPage;if(b._elements.$filter.val()===""){b._elements.$columnSelect.val("");b._handleColumnChange()}b._disablePrevButton();b._values.fetchLovMode="DIALOG";b._fetchLov()},_updatePaginationDisplay:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Update Pagination Display ("+b._values.apexItemId+")")}b._elements.$paginationDisplay.html("Page "+b._values.curPage)},_disableSearchButton:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Disable Search Button ("+b._values.apexItemId+")")}b._disableButton("search")},_disablePrevButton:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Disable Prev Button ("+b._values.apexItemId+")")}b._disableButton("prev")},_disableNextButton:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Disable Next Button ("+b._values.apexItemId+")")}b._disableButton("next")},_disableButton:function(d){var c=this;var b;if(c.options.debug){apex.debug("Super LOV - Disable Button ("+c._values.apexItemId+")")}if(d=="search"){b=c._elements.$searchButton;b.attr("disabled","disabled").removeClass("ui-state-hover").removeClass("ui-state-focus").css("cursor","default");return}else{if(d=="prev"){b=c._elements.$prevButton}else{if(d=="next"){b=c._elements.$nextButton}}}b.attr("disabled","disabled").removeClass("ui-state-hover").removeClass("ui-state-focus").css({opacity:"0.5",cursor:"default"})},_enableSearchButton:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Enable Search Button ("+b._values.apexItemId+")")}b._enableButton("search")},_enablePrevButton:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Enable Prev Button ("+b._values.apexItemId+")")}b._enableButton("prev")},_enableNextButton:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Enable Next Button ("+b._values.apexItemId+")")}b._enableButton("next")},_enableButton:function(d){var c=this;var b;if(c.options.debug){apex.debug("Super LOV - Enable Button ("+c._values.apexItemId+")")}if(d=="search"){b=c._elements.$searchButton;b.removeAttr("disabled").css("cursor","pointer");return}else{if(d=="prev"){b=c._elements.$prevButton}else{if(d=="next"){b=c._elements.$nextButton}}}b.removeAttr("disabled").css({opacity:"1",cursor:"pointer"})},_highlightSelectedRow:function(){var c=this;var b=a('table.superlov-table tbody tr[data-return="'+c._elements.$hiddenInput.val()+'"]');if(c.options.debug){apex.debug("Super LOV - Highlight Selected Row ("+c._values.apexItemId+")")}b.children("td").removeClass("ui-state-default").addClass("ui-state-active")},_handleMainTrMouseenter:function(e){var d=e.data.uiw;var b=a(e.currentTarget);var c=d._elements.$table.find("tbody>tr").has("td.ui-state-hover");if(d.options.debug){apex.debug("Super LOV: _handleMainTrMouseenter ("+d._values.apexItemId+")")}if(c.length){if(c.children("td.ui-state-hover-active").length){c.children("td").removeClass("ui-state-hover ui-state-hover-active").addClass("ui-state-active")}else{c.children("td").removeClass("ui-state-hover").addClass("ui-state-default")}}if(b.children("td:not(.ui-state-active)").length){b.children("td").removeClass("ui-state-default").addClass("ui-state-hover")}else{b.children("td").removeClass("ui-state-active").addClass("ui-state-hover ui-state-hover-active")}},_handleMainTrMouseleave:function(d){var c=d.data.uiw;var b=a(d.currentTarget);if(c.options.debug){apex.debug("Super LOV: _handleMainTrMouseleave ("+c._values.apexItemId+")")}if(b.children("td.ui-state-hover-active").length){b.children("td").removeClass("ui-state-hover ui-state-hover-active").addClass("ui-state-active")}else{b.children("td").removeClass("ui-state-hover").addClass("ui-state-default")}},_handleMainTrClick:function(c){var b=c.data.uiw;b._elements.$selectedRow=a(c.currentTarget);b._setValuesFromRow()},_setValuesFromRow:function(){var e=this;var d;var c=e._elements.$selectedRow.attr("data-return");var b=e._elements.$selectedRow.attr("data-display");if(e.options.debug){apex.debug("Super LOV - Set values from row ("+e._values.apexItemId+")");apex.debug('...returnVal: "'+c+'"');apex.debug('...displayVal: "'+b+'"')}d=e._elements.$hiddenInput.val()!==c;if(e.options.debug){apex.debug('...valChanged: "'+d+'"')}e._elements.$hiddenInput.val(c);e._elements.$displayInput.val(b);e._values.lastDisplayValue=b;for(x=0;x<e._values.mapToItems.length;x++){if(e._isHiddenCol(e._values.mapFromCols[x])){$s(e._values.mapToItems[x],e._elements.$selectedRow.attr("data-col"+e._values.mapFromCols[x]+"-value"))}else{$s(e._values.mapToItems[x],e._elements.$selectedRow.children("td.asl-col"+e._values.mapFromCols[x]).text())}}if(e._values.fetchLovMode==="DIALOG"){if(e.options.debug){apex.debug("...In dialog mode; close dialog")}e._elements.$dialog.dialog("close")}if(d){e.allowChangePropagation();e._elements.$hiddenInput.trigger("change");e._elements.$displayInput.trigger("change");e.preventChangePropagation()}},_handleSearchButtonClick:function(c){var b=c.data.uiw;if(b.options.debug){apex.debug("Super LOV - Handle Search Button Click ("+b._values.apexItemId+")")}b._search()},_handlePrevButtonClick:function(e){var d=e.data.uiw;var b;var c;if(d.options.debug){apex.debug("Super LOV - Handle Prev Button Click ("+d._values.apexItemId+")")}d._values.fetchLovMode="DIALOG";d._values.curPage=d._values.curPage-1;if(d._values.curPage===1){b=1;c=d.options.maxRowsPerPage;d._values.pagination=b+":"+c;d._fetchLov();d._disablePrevButton()}else{b=((d._values.curPage-1)*d.options.maxRowsPerPage)+1;c=d._values.curPage*d.options.maxRowsPerPage;d._values.pagination=b+":"+c;d._fetchLov();d._enablePrevButton()}},_handleNextButtonClick:function(e){var d=e.data.uiw;var b;var c;if(d.options.debug){apex.debug("Super LOV - Handle Next Button Click ("+d._values.apexItemId+")")}d._values.fetchLovMode="DIALOG";d._values.curPage=d._values.curPage+1;b=((d._values.curPage-1)*d.options.maxRowsPerPage)+1;c=d._values.curPage*d.options.maxRowsPerPage;d._values.pagination=b+":"+c;d._fetchLov();d._elements.$paginationDisplay.html("Page "+d._values.curPage);if(d._values.curPage>=2&&d._elements.$prevButton.attr("disabled")){d._enablePrevButton()}},_refresh:function(){var c=this;var b=c._elements.$hiddenInput.val();if(c.options.debug){apex.debug("Super LOV - Refresh ("+c._values.apexItemId+")")}c._elements.$displayInput.trigger("apexbeforerefresh");c._elements.$hiddenInput.val("");c._elements.$displayInput.val("");c._values.lastDisplayValue="";for(x=0;x<c._values.mapToItems.length;x++){$s(c._values.mapToItems[x],"")}c._elements.$displayInput.trigger("apexafterrefresh");if(b!==c._elements.$hiddenInput.val()){c.allowChangePropagation();c._elements.$hiddenInput.trigger("change");c._elements.$displayInput.trigger("change");c.preventChangePropagation()}return false},_updateLovMeasurements:function(){var q=this;var l;var n=25;var m=false;var c=false;var d=true;var k;var s;var f;var h;var b;var r;var e;var j;var p;var o;var g;if(q.options.debug){apex.debug("Super LOV - Update LOV Measurements ("+q._values.apexItemId+")")}if(!q._elements.$nodata.length){l=q._elements.$table}else{d=false;l=q._elements.$nodata}k=a("div.superlov-dialog div.ui-dialog-titlebar").outerHeight(true)+q._elements.$buttonContainer.outerHeight(true)+a("div.superlov-dialog div.ui-dialog-buttonpane").outerHeight(true)+(q._elements.$dialog.outerHeight(true)-q._elements.$dialog.height())+(q._elements.$wrapper.outerHeight(true)-q._elements.$wrapper.height());s=q._elements.$outerDialog.css("max-height");if(q._values.percentRegExp.test(s)){s=parseFloat(s);s=q._elements.$window.height()*(s/100)}else{if(q._values.pixelRegExp.test(s)){s=parseFloat(s)}else{s=q._elements.$window.height()*0.9}}s=q._elements.$window.height()*0.9;h=q._elements.$dialog.outerWidth(true)-q._elements.$dialog.width();b=q._elements.$outerDialog.css("min-width");if(q._values.percentRegExp.test(b)){b=parseFloat(b);b=q._elements.$window.width()*(b/100)}else{if(q._values.pixelRegExp.test(b)){b=parseFloat(b)}else{b=q._elements.$buttonContainer.outerWidth(true)}}r=q._elements.$outerDialog.css("max-width");if(q._values.percentRegExp.test(r)){r=parseFloat(r);r=q._elements.$window.width()*(r/100)}else{if(q._values.pixelRegExp.test(r)){r=parseFloat(r)}else{r=q._elements.$window.width()*0.9}}r=q._elements.$window.width()*0.9;if(k+l.outerHeight(true)>s){m=true;f=s-k}else{f=l.outerHeight(true)}if(d){e=l.outerWidth(true);if(m){e=e+n}if(h+e<b){e=b-h}else{if(h+e>r){c=true;e=r-h;if(e<b){e=b-h}}}if(c&&!m){if(k+l.outerHeight(true)+n>s){m=true;f=s-k}else{f=l.outerHeight(true)+n}}}else{e=b-h}p=k+f;j=h+e;q._values.wrapperHeight=f;q._values.wrapperWidth=e;q._values.dialogHeight=p;q._values.dialogWidth=j;o=(q._values.dialogWidth-q._elements.$outerDialog.width())/2;g=q._elements.$outerDialog.css("left");if(q._values.percentRegExp.test(g)){g=parseFloat(g);g=q._elements.$window.width()*(g/100)}else{if(q._values.pixelRegExp.test(g)){g=parseFloat(g)}else{g=0}}g=g-o;if(g<0){g=0}q._values.dialogLeft=g;q._values.dialogTop=q._elements.$window.height()*0.05+a(document).scrollTop()},_updateStyledFilter:function(){var d=this;var c=d._elements.$filter.css("background-color");var f=d._elements.$filter.css("background-image");var g=d._elements.$filter.css("background-repeat");var b=d._elements.$filter.css("background-attachment");var e=d._elements.$filter.css("background-position");if(d.options.debug){apex.debug("Super LOV - Update Styled Filter ("+d._values.apexItemId+")")}a("#superlov_styled_filter").css({"background-color":c,"background-image":f,"background-repeat":g,"background-attachment":b,"background-position":e})},_updateStyledInput:function(){var d=this;var c=d._elements.$displayInput.css("background-color");var f=d._elements.$displayInput.css("background-image");var g=d._elements.$displayInput.css("background-repeat");var b=d._elements.$displayInput.css("background-attachment");var e=d._elements.$displayInput.css("background-position");if(d.options.debug){apex.debug("Super LOV - Update Styled Input ("+d._values.apexItemId+")")}d._elements.$fieldset.css({"background-color":c,"background-image":f,"background-repeat":g,"background-attachment":b,"background-position":e})},_handleClearClick:function(d){var c=d.data.uiw;var b=c._elements.$clearButton.find("span.ui-icon");if(c.options.debug){apex.debug("Super LOV - Clear LOV ("+c._values.apexItemId+")")}if(d.screenX!==0&&d.screenY!==0){d.target.blur()}if(c._elements.$displayInput.val()!==""){if(c.options.useClearProtection==="N"){c._refresh()}else{if(b.hasClass("ui-icon-circle-close")){b.removeClass("ui-icon-circle-close").addClass("ui-icon-alert");c._values.deleteIconTimeout=setTimeout("$('#"+c._values.controlsId+" button>span.ui-icon-alert').removeClass('ui-icon-alert').addClass('ui-icon-circle-close');",1000)}else{clearTimeout(c._values.deleteIconTimeout);c._values.deleteIconTimeout="";c._refresh();b.removeClass("ui-icon-alert").addClass("ui-icon-circle-close")}}}},_disableArrowKeyScrolling:function(d){var c=d.data.uiw;var b=d.which;if(b===37||b===39){if(c._values.bodyKeyMode==="ROWSELECT"){d.preventDefault();return false}}else{if(b===38||b===40){d.preventDefault();return false}}return true},_handleFilterFocus:function(c){var b=c.data.uiw;b._values.bodyKeyMode="SEARCH"},disable:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Disabling Item ("+b._values.apexItemId+")")}if(b._values.disabled===false){if(b.options.enterable===b._values.ENTERABLE_RESTRICTED||b.options.enterable===b._values.ENTERABLE_UNRESTRICTED){b._elements.$displayInput.attr("disabled","disabled").unbind("keypress",b._handleEnterableKeypress).unbind("blur",{uiw:b},b._handleEnterableBlur)}b._elements.$hiddenInput.attr("disabled","disabled");b._elements.$openButton.unbind("click",b._handleOpenClick);b._elements.$clearButton.unbind("click",b._handleClearClick);b._elements.$itemHolder.find("div.superlov-control-buttons").buttonset("disable")}b._values.disabled=true},enable:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Enabling Item ("+b._values.apexItemId+")")}if(b._values.disabled===true){if(b.options.enterable===b._values.ENTERABLE_RESTRICTED||b.options.enterable===b._values.ENTERABLE_UNRESTRICTED){b._elements.$displayInput.removeAttr("disabled").bind("keypress",{uiw:b},b._handleEnterableKeypress).bind("blur",{uiw:b},b._handleEnterableBlur)}b._elements.$hiddenInput.removeAttr("disabled");b._elements.$openButton.bind("click",{uiw:b},b._handleOpenClick);b._elements.$clearButton.bind("click",{uiw:b},b._handleClearClick);b._elements.$itemHolder.find("div.superlov-control-buttons").buttonset("enable")}b._values.disabled=false},hide:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Hiding Item ("+b._values.apexItemId+")")}b._elements.$fieldset.hide();b._elements.$label.hide()},show:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Showing Item ("+b._values.apexItemId+")")}b._elements.$fieldset.show();b._elements.$label.show()},hideRow:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Hiding Row ("+b._values.apexItemId+")")}b._elements.$label.closest("tr").hide()},showRow:function(){var b=this;if(b.options.debug){apex.debug("Super LOV - Showing Row ("+b._values.apexItemId+")")}b._elements.$label.closest("tr").show()},allowChangePropagation:function(){var b=this;b._values.changePropagationAllowed=true},preventChangePropagation:function(){var b=this;b._values.changePropagationAllowed=false},changePropagationAllowed:function(){var b=this;return b._values.changePropagationAllowed},getValuesByReturn:function(b){var c=this;if(c.options.debug){apex.debug("Super LOV - Getting Values by Return Value ("+c._values.apexItemId+")")}queryString={p_flow_id:a("#pFlowId").val(),p_flow_step_id:a("#pFlowStepId").val(),p_instance:a("#pInstance").val(),p_request:"PLUGIN="+c.options.ajaxIdentifier,x01:"GET_VALUES_BY_RETURN",x06:b};a.ajax({type:"POST",url:"wwv_flow.show",data:queryString,dataType:"json",async:false,success:function(d){if(c.options.debug){apex.debug(d)}c._values.ajaxReturn=d}});return c._values.ajaxReturn},setValuesByReturn:function(b){var c=this;var d;d=c.getValuesByReturn(b);if(d.error!==undefined){if(c._elements.$fieldset.hasClass("super-lov-not-enterable")||c._elements.$fieldset.hasClass("super-lov-enterable-restricted")){c._elements.$hiddenInput.val("");c._elements.$displayInput.val("");c._values.lastDisplayValue=""}else{if(c._elements.$fieldset.hasClass("super-lov-enterable-unrestricted")){c._elements.$hiddenInput.val(b);c._elements.$displayInput.val(b);c._values.lastDisplayValue=b}}for(x=0;x<c._values.mapToItems.length;x++){$s(c._values.mapToItems[x],"")}}else{if(!d.matchFound){if(c._elements.$fieldset.hasClass("super-lov-not-enterable")||c._elements.$fieldset.hasClass("super-lov-enterable-restricted")){c._elements.$hiddenInput.val("");c._elements.$displayInput.val("");c._values.lastDisplayValue=""}else{if(c._elements.$fieldset.hasClass("super-lov-enterable-unrestricted")){c._elements.$hiddenInput.val(b);c._elements.$displayInput.val(b);c._values.lastDisplayValue=b}}for(x=0;x<c._values.mapToItems.length;x++){$s(c._values.mapToItems[x],"")}}else{c._elements.$hiddenInput.val(d.returnVal);c._elements.$displayInput.val(d.displayVal);c._values.lastDisplayValue=d.displayVal;if(d.mappedColumns){for(x=0;x<d.mappedColumns.length;x++){$s(d.mappedColumns[x].mapItem,d.mappedColumns[x].mapVal)}}}}}})})(apex.jQuery);